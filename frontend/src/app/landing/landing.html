<!-- Use shared layout component -->
<app-layout [user]="user$ | async" [loading]="false" [error]="''">
  <!-- Hero Section -->
  <section id="hero" class="min-h-screen bg-gradient-to-br from-primary-50 to-primary-100 flex items-center pt-20">
    <div class="container grid lg:grid-cols-2 gap-16 items-center">
      <div class="hero-content">
        <h1 class="text-5xl lg:text-6xl font-extrabold leading-tight mb-8 text-gray-900">
          Sistem Pemantauan <span class="gradient-text">Taman Nepenthes</span>
        </h1>
        <p class="text-xl text-gray-600 mb-10 leading-relaxed">
          Pantau suhu, kelembaban tanah, intensitas cahaya, dan kekeruhan air pada taman nepenthes secara real-time dan jaga pertumbuhan nepenthes dengan teknologi cerdas.
        </p>
        <div class="flex gap-6 flex-wrap">
          <!-- Show different buttons based on authentication status -->
          <ng-container *ngIf="user$ | async as user; else loginButton">
            <button class="btn btn-primary btn-large" (click)="goToDashboard()">
              <span>📊 Buka Dashboard</span>
            </button>
          </ng-container>
          <ng-template #loginButton>
            <button class="btn btn-primary btn-large" (click)="loginWithGoogle()">
              <span>🔐 Masuk dengan Google</span>
            </button>
          </ng-template>
          <button class="btn btn-secondary btn-large" (click)="scrollToFeatures()">
            <span>✨ Pelajari Lebih Lanjut</span>
          </button>
        </div>
      </div>
      <div class="grid grid-cols-2 gap-6 grid-rows-2">
        <div class="feature-card">
          <div class="feature-icon">🌡️</div>
          <h3 class="feature-title">Sensor Suhu</h3>
          <p class="feature-description">Pemantauan suhu real-time</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">💧</div>
          <h3 class="feature-title">Kelembaban Tanah</h3>
          <p class="feature-description">Monitoring kelembaban tanah</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">💡</div>
          <h3 class="feature-title">Intensitas Cahaya</h3>
          <p class="feature-description">Pengukuran intensitas cahaya</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">🌫️</div>
          <h3 class="feature-title">Kekeruhan Air</h3>
          <p class="feature-description">Pengukuran kekeruhan air</p>
        </div>
      </div>
    </div>
  </section>

  <!-- About Section -->
  <section id="about" class="py-24 bg-gray-50">
    <div class="container">
      <div class="grid lg:grid-cols-2 gap-20 items-center">
        <div class="about-text">
          <ng-container *ngIf="about$ | async as about; else defaultAbout">
            <h2 class="text-4xl lg:text-5xl font-bold mb-8 text-gray-900">{{ about.title }}</h2>
            <p class="text-lg text-gray-600 mb-10 leading-relaxed">{{ about.description }}</p>
          </ng-container>
          <ng-template #defaultAbout>
            <h2 class="text-4xl lg:text-5xl font-bold mb-8 text-gray-900">Tentang Nestle Kebun Raya</h2>
            <p class="text-lg text-gray-600 mb-8 leading-relaxed">
              Nestle adalah platform canggih yang didedikasikan untuk memajukan penelitian
              dan konservasi lingkungan. Misi kami adalah menghubungkan para peneliti untuk
              berkolaborasi dalam merawat dan menjaga tanaman yang terancam punah.
            </p>
            <p class="text-lg text-gray-600 mb-10 leading-relaxed">
              Dengan teknologi mutakhir dan komitmen terhadap pelestarian lingkungan,
              kami membangun masa depan di mana alam dan teknologi bekerja bersama secara harmonis.
            </p>
          </ng-template>
        </div>
        <div class="about-image">
          <ng-container *ngIf="about$ | async as about; else defaultImage">
            <img *ngIf="about.image" [src]="environment.apiUrl + '/storage/' + about.image" [alt]="about.title"
              class="w-full h-96 object-cover rounded-2xl shadow-lg" loading="lazy">
          </ng-container>
          <ng-template #defaultImage>
            <div
              class="w-full h-96 bg-gradient-to-br from-primary-100 to-primary-200 rounded-2xl shadow-lg flex items-center justify-center">
              <div class="text-center">
                <span class="text-6xl mb-4 block">🌿</span>
                <p class="text-gray-600 text-lg">Gambar Kebun Raya</p>
              </div>
            </div>
          </ng-template>
        </div>
      </div>
    </div>
  </section>


  <!-- Plant Type Carousel -->

  <section id="plant-type-carousel" class="bg-white">
    <div class="px-12 py-16">
      <ng-container *ngIf="!isLoadingPlantTypes; else loadingPlantTypes">
        <ng-container *ngIf="plantTypes.length > 0; else noPlantTypes">
          <div class="relative">
            <div class="text-left">
              <h2 class="text-4xl lg:text-5xl font-bold text-gray-900">Jenis Kantong Semar</h2>
              <p class="text-xl text-gray-600 text-left mt-2 mb-8">
                Jelajahi berbagai jenis kantong semar yang kami kelola, masing-masing dengan karakteristik unik dan
                keindahan tersendiri.
              </p>
            </div>
            <!-- Carousel Container -->
            <div class="relative overflow-hidden rounded-2xl shadow-lg">
              <!-- Plant Type Content -->
              <div class="transition-transform duration-500 ease-in-out">
                <div
                  class="bg-gradient-to-br from-primary-50 to-primary-100 grid grid-cols-12 gap-8 items-center p-8 bg-white">
                  <div class="col-span-12 lg:col-span-4">
                    <div class="relative">
                      <ng-container
                        *ngIf="plantTypes[currentPlantTypeIndex].images && plantTypes[currentPlantTypeIndex].images.length > 0; else defaultImage">
                        <img
                          [src]="environment.apiUrl + '/storage/' + plantTypes[currentPlantTypeIndex].images[0].image"
                          [alt]="plantTypes[currentPlantTypeIndex].name"
                          class="w-full h-64 object-cover rounded-2xl shadow-lg cursor-pointer hover:scale-105 transition-transform duration-200"
                          (click)="openImageModal(currentPlantTypeIndex, 0)">

                        <!-- Image count indicator -->
                        <div *ngIf="plantTypes[currentPlantTypeIndex].images.length > 1"
                          class="absolute bottom-3 right-3 bg-black/70 text-white px-3 py-1 rounded-full text-sm font-medium">
                          <span class="flex items-center gap-1">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z">
                              </path>
                            </svg>
                            {{ plantTypes[currentPlantTypeIndex].images.length }} foto
                          </span>
                        </div>
                      </ng-container>
                      <ng-template #defaultImage>
                        <div
                          class="w-full h-64 bg-gradient-to-br from-green-100 to-green-200 rounded-2xl shadow-lg flex items-center justify-center">
                          <div class="text-center">
                            <span class="text-6xl mb-4 block">🌿</span>
                            <p class="text-gray-600">Gambar Tanaman</p>
                          </div>
                        </div>
                      </ng-template>
                    </div>

                    <!-- Click hint text -->
                    <div
                      *ngIf="plantTypes[currentPlantTypeIndex].images && plantTypes[currentPlantTypeIndex].images.length > 0"
                      class="mt-3 text-center">
                      <p class="text-sm text-gray-500 flex items-center justify-center gap-1">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z">
                          </path>
                        </svg>
                        Klik untuk melihat semua foto
                      </p>
                    </div>
                  </div>
                  <div class="col-span-12 lg:col-span-8">
                    <h3 class="text-3xl font-bold mb-4 text-gray-900">{{ plantTypes[currentPlantTypeIndex].name }}</h3>
                    <p class="text-lg text-gray-600 leading-relaxed">{{ plantTypes[currentPlantTypeIndex].description }}
                    </p>
                  </div>
                </div>
              </div>

              <!-- Daftar Small Gambar Tipe Tanaman - Hidden by default, shown in modal -->
              <!-- <div class="grid grid-cols-12 gap-4 items-center p-4 bg-white">
                  <div class="col-span-6 md:col-span-3 lg:col-span-2" *ngFor="let image of plantTypes[currentPlantTypeIndex].images; let imageIndex = index">
                    <img [src]="environment.apiUrl + '/storage/' + image.image" 
                         [alt]="plantTypes[currentPlantTypeIndex].name" 
                         class="w-full h-32 object-cover rounded-lg shadow-md cursor-pointer hover:scale-105 transition-transform duration-200"
                         (click)="openImageModal(currentPlantTypeIndex, imageIndex)">
                  </div>
                </div> -->

              <!-- Navigation Arrows -->
              <button (click)="previousPlantType()"
                class="absolute left-4 top-1/2 transform -translate-y-1/2 bg-white/80 hover:bg-white text-gray-800 hover:text-primary-600 p-3 rounded-full shadow-lg transition-all duration-200 hover:scale-110 z-10"
                [class.opacity-50]="plantTypes.length <= 1" [disabled]="plantTypes.length <= 1">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
              </button>

              <button (click)="nextPlantType()"
                class="absolute right-4 top-1/2 transform -translate-y-1/2 bg-white/80 hover:bg-white text-gray-800 hover:text-primary-600 p-3 rounded-full shadow-lg transition-all duration-200 hover:scale-110 z-10"
                [class.opacity-50]="plantTypes.length <= 1" [disabled]="plantTypes.length <= 1">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
              </button>
            </div>

            <!-- Carousel Indicators -->
            <div class="flex justify-center mt-8 space-x-2">
              <button *ngFor="let plantType of plantTypes; let i = index" (click)="goToPlantType(i)"
                class="w-3 h-3 rounded-full transition-all duration-200"
                [class.bg-primary-500]="i === currentPlantTypeIndex" [class.bg-gray-300]="i !== currentPlantTypeIndex"
                [class.hover:bg-primary-400]="i !== currentPlantTypeIndex">
              </button>
            </div>

            <!-- Plant Type Counter -->
            <div class="text-center mt-4 text-gray-600">
              <span class="font-medium">{{ currentPlantTypeIndex + 1 }}</span>
              <span class="mx-2">dari</span>
              <span class="font-medium">{{ plantTypes.length }}</span>
            </div>
          </div>
        </ng-container>
        <ng-template #noPlantTypes>
          <div class="text-center py-12">
            <span class="text-6xl mb-4 block">🌱</span>
            <p class="text-xl text-gray-600">Belum ada data tanaman yang tersedia</p>
          </div>
        </ng-template>
      </ng-container>
      <ng-template #loadingPlantTypes>
        <div class="text-center py-12">
          <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"></div>
          <p class="text-gray-600">Memuat data tanaman...</p>
        </div>
      </ng-template>
    </div>
  </section>

  <!-- Sensor Section-->
  <section id="sensor" class="py-8 bg-gray-50">
    <div class="mx-8">

      <!-- Temperature Sensors Section -->
      <div class="card mb-8">
        <div class="section-header">
          <h2 class="text-3xl font-bold text-gray-900 mb-3">🌡️ Sensor Suhu</h2>
          <p class="text-gray-600">Pemantauan suhu real-time di semua sensor (30 Menit terakhir)</p>
        </div>

        <!-- Individual Sensor Rows -->
        <div class="space-y-8" *ngIf="sensorsData.length > 0">
          <div class="bg-gradient-to-r from-primary-50 to-primary-100 rounded-2xl p-8 border border-primary-200"
            *ngFor="let sensor of sensorsData; let i = index">
            <div class="grid lg:grid-cols-12 gap-9">
              <div class="chart-container lg:col-span-9">
                <div class="mb-4">
                  <h4 class="text-lg font-semibold text-gray-900">📊 {{ sensor.name }} - Tren Suhu (30 Menit Terakhir)
                  </h4>
                </div>

                <div class="chart-wrapper">
                  <apx-chart [series]="getChartSeries(sensor)" [chart]="getChartOptions(sensor)"
                    [colors]="getChartColors(i)" [stroke]="getChartStroke()" [fill]="getChartFill()"
                    [markers]="getChartMarkers(i)" [xaxis]="getChartXAxis()" [yaxis]="getChartYAxis()"
                    [legend]="getChartLegend()" [tooltip]="getChartTooltip()" [grid]="getChartGrid()"
                    [theme]="getChartTheme()">
                  </apx-chart>
                </div>
              </div>
              <div class="sensor-info lg:col-span-3">
                <div class="card p-6 h-full flex flex-col">
                  <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-900">{{ sensor.name }}</h3>
                    <div class="flex items-center gap-3">
                      <div class="status-dot"
                        [class]="sensor.latest_value !== null ? 'status-online' : 'status-offline'">
                      </div>
                      <span class="text-sm font-semibold"
                        [class]="sensor.latest_value !== null ? 'text-success-600' : 'text-gray-500'">
                        {{ sensor.latest_value !== null ? 'Online' : 'Offline' }}
                      </span>
                    </div>
                  </div>

                  <div class="flex-1 flex flex-col justify-center items-center text-center"
                    *ngIf="sensor.latest_value !== null">
                    <div class="sensor-value text-center">{{ sensor.latest_value }}°C</div>
                    <div class="sensor-timestamp text-center">{{ sensor.latest_timestamp | date:'short' }}</div>
                  </div>

                  <div class="flex-1 flex flex-col justify-center items-center text-center"
                    *ngIf="sensor.latest_value === null">
                    <div class="sensor-value-offline text-center">--°C</div>
                    <div class="sensor-timestamp text-center">Tidak ada data</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Temperature Data Table -->
            <div class="mt-8 bg-white rounded-lg border border-gray-200">
              <div class="px-6 py-4 border-b border-gray-200">
                <h5 class="text-lg font-semibold text-gray-900">📋 Data Terbaru (30 Menit Terakhir)</h5>
              </div>

              <!-- Loading State -->
              <div *ngIf="temperatureTableLoading" class="text-center py-8">
                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-2"></div>
                <p class="text-gray-600">Memuat data suhu...</p>
              </div>

              <!-- Data Table -->
              <div *ngIf="!temperatureTableLoading && temperatureTableData" class="overflow-x-auto">
                <table class="min-w-full bg-white">
                  <thead class="bg-gray-50">
                    <tr>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama
                        Sensor</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Suhu
                        (°C)</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Waktu
                      </th>
                    </tr>
                  </thead>
                  <tbody class="bg-white divide-y divide-gray-200">
                    <tr *ngFor="let item of temperatureTableData.data; let i = index" class="hover:bg-gray-50">
                      <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{
                        (temperatureTableData.current_page - 1) * temperatureTableData.per_page + i + 1 }}</td>
                      <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ item.name }}</td>
                      <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ item.value }}°C</td>
                      <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ formatTableDate(item.created_at)
                        }}</td>
                    </tr>
                  </tbody>
                </table>

                <!-- Pagination -->
                <div class="px-6 py-4 border-t border-gray-200"
                  *ngIf="temperatureTableData && temperatureTableData.last_page > 1">
                  <app-pagination [currentPage]="temperatureTableData.current_page"
                    [totalPages]="temperatureTableData.last_page" [totalItems]="temperatureTableData.total"
                    [itemsPerPage]="temperatureTableData.per_page" (pageChange)="onTemperatureTablePageChange($event)">
                  </app-pagination>
                </div>
              </div>

              <!-- No Data State -->
              <div *ngIf="!temperatureTableLoading && (!temperatureTableData || temperatureTableData.data.length === 0)"
                class="text-center py-8">
                <div class="text-4xl mb-2">🌡️</div>
                <p class="text-gray-600">Tidak ada data suhu ditemukan</p>
              </div>
            </div>
          </div>
        </div>

        <!-- No Data State -->
        <div class="text-center py-16" *ngIf="sensorsData.length === 0">
          <div class="text-8xl mb-6">🌡️</div>
          <h3 class="text-xl font-bold text-gray-900 mb-4">Tidak Ada Sensor Suhu Ditemukan</h3>
          <p class="text-gray-600 text-lg">Data sensor suhu tidak tersedia saat ini.</p>
        </div>
      </div>

      <!-- Soil Moisture Sensors Section -->
      <div class="card mb-8">
        <div class="section-header">
          <h2 class="text-3xl font-bold text-gray-900 mb-3">💧 Sensor Kelembaban Tanah</h2>
          <p class="text-gray-600">Pemantauan kelembaban tanah real-time di semua sensor (30 Menit terakhir)</p>
        </div>

        <div class="space-y-8" *ngIf="soilMoistureSensorsData.length > 0">
          <div class="bg-gradient-to-r from-primary-50 to-primary-100 rounded-2xl p-8 border border-primary-200"
            *ngFor="let sensor of soilMoistureSensorsData; let i = index">
            <div class="grid lg:grid-cols-12 gap-9">
              <div class="chart-container lg:col-span-9">
                <div class="mb-4">
                  <h4 class="text-lg font-semibold text-gray-900">📊 {{ sensor.name }} - Tren Kelembaban Tanah (30 Menit
                    Terakhir)</h4>
                </div>

                <div class="chart-wrapper">
                  <apx-chart [series]="getSoilMoistureChartSeries(sensor)" [chart]="getChartOptions(sensor)"
                    [colors]="getChartColors(i)" [stroke]="getChartStroke()" [fill]="getChartFill()"
                    [markers]="getChartMarkers(i)" [xaxis]="getChartXAxis()" [yaxis]="getSoilMoistureChartYAxis()"
                    [legend]="getChartLegend()" [tooltip]="getSoilMoistureChartTooltip()" [grid]="getChartGrid()"
                    [theme]="getChartTheme()">
                  </apx-chart>
                </div>
              </div>

              <div class="sensor-info lg:col-span-3">
                <div class="card p-6 h-full flex flex-col">
                  <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-900">{{ sensor.name }}</h3>
                    <div class="flex items-center gap-3">
                      <div class="status-dot"
                        [class]="sensor.latest_value !== null ? 'status-online' : 'status-offline'">
                      </div>
                      <span class="text-sm font-semibold"
                        [class]="sensor.latest_value !== null ? 'text-success-600' : 'text-gray-500'">
                        {{ sensor.latest_value !== null ? 'Online' : 'Offline' }}
                      </span>
                    </div>
                  </div>

                  <div class="flex-1 flex flex-col justify-center items-center text-center"
                    *ngIf="sensor.latest_value !== null">
                    <div class="sensor-value text-center">{{ sensor.latest_value }}%</div>
                    <div class="sensor-timestamp text-center">{{ sensor.latest_timestamp | date:'short' }}</div>
                  </div>

                  <div class="flex-1 flex flex-col justify-center items-center text-center"
                    *ngIf="sensor.latest_value === null">
                    <div class="sensor-value-offline text-center">--%</div>
                    <div class="sensor-timestamp text-center">Tidak ada data</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Soil Moisture Data Table -->
            <div class="mt-8 bg-white rounded-lg border border-gray-200">
              <div class="px-6 py-4 border-b border-gray-200">
                <h5 class="text-lg font-semibold text-gray-900">📋 Data Terbaru (30 Menit Terakhir)</h5>
              </div>

              <!-- Loading State -->
              <div *ngIf="soilMoistureTableLoading" class="text-center py-8">
                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-2"></div>
                <p class="text-gray-600">Memuat data kelembaban tanah...</p>
              </div>

              <!-- Data Table -->
              <div *ngIf="!soilMoistureTableLoading && soilMoistureTableData" class="overflow-x-auto">
                <table class="min-w-full bg-white">
                  <thead class="bg-gray-50">
                    <tr>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama
                        Sensor</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                        Kelembaban Tanah (%)</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Waktu
                      </th>
                    </tr>
                  </thead>
                  <tbody class="bg-white divide-y divide-gray-200">
                    <tr *ngFor="let item of soilMoistureTableData.data; let i = index" class="hover:bg-gray-50">
                      <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{
                        (soilMoistureTableData.current_page - 1) * soilMoistureTableData.per_page + i + 1 }}</td>
                      <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ item.name }}</td>
                      <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ item.value }}%</td>
                      <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ formatTableDate(item.created_at)
                        }}</td>
                    </tr>
                  </tbody>
                </table>

                <!-- Pagination -->
                <div class="px-6 py-4 border-t border-gray-200"
                  *ngIf="soilMoistureTableData && soilMoistureTableData.last_page > 1">
                  <app-pagination [currentPage]="soilMoistureTableData.current_page"
                    [totalPages]="soilMoistureTableData.last_page" [totalItems]="soilMoistureTableData.total"
                    [itemsPerPage]="soilMoistureTableData.per_page"
                    (pageChange)="onSoilMoistureTablePageChange($event)">
                  </app-pagination>
                </div>
              </div>

              <!-- No Data State -->
              <div
                *ngIf="!soilMoistureTableLoading && (!soilMoistureTableData || soilMoistureTableData.data.length === 0)"
                class="text-center py-8">
                <div class="text-4xl mb-2">💧</div>
                <p class="text-gray-600">Tidak ada data kelembaban tanah ditemukan</p>
              </div>
            </div>
          </div>
        </div>

        <div class="text-center py-16" *ngIf="soilMoistureSensorsData.length === 0">
          <div class="text-8xl mb-6">💧</div>
          <h3 class="text-xl font-bold text-gray-900 mb-4">Tidak Ada Sensor Kelembaban Tanah Ditemukan</h3>
          <p class="text-gray-600 text-lg">Data sensor kelembaban tanah tidak tersedia saat ini.</p>
        </div>
      </div>

      <!-- Light Sensors Section -->
      <div class="card mb-8">
        <div class="section-header">
          <h2 class="text-3xl font-bold text-gray-900 mb-3">💡 Sensor Cahaya</h2>
          <p class="text-gray-600">Pemantauan intensitas cahaya real-time di semua sensor (30 Menit terakhir)</p>
        </div>

        <div class="space-y-8" *ngIf="lightSensorsData.length > 0">
          <div class="bg-gradient-to-r from-primary-50 to-primary-100 rounded-2xl p-8 border border-primary-200"
            *ngFor="let sensor of lightSensorsData; let i = index">
            <div class="grid lg:grid-cols-12 gap-9">
              <div class="chart-container lg:col-span-9">
                <div class="mb-4">
                  <h4 class="text-lg font-semibold text-gray-900">📊 {{ sensor.name }} - Tren Intensitas Cahaya (30
                    Menit Terakhir)</h4>
                </div>

                <div class="chart-wrapper">
                  <apx-chart [series]="getLightChartSeries(sensor)" [chart]="getChartOptions(sensor)"
                    [colors]="getChartColors(i)" [stroke]="getChartStroke()" [fill]="getChartFill()"
                    [markers]="getChartMarkers(i)" [xaxis]="getChartXAxis()" [yaxis]="getLightChartYAxis()"
                    [legend]="getChartLegend()" [tooltip]="getLightChartTooltip()" [grid]="getChartGrid()"
                    [theme]="getChartTheme()">
                  </apx-chart>
                </div>
              </div>

              <div class="sensor-info lg:col-span-3">
                <div class="card p-6 h-full flex flex-col">
                  <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-900">{{ sensor.name }}</h3>
                    <div class="flex items-center gap-3">
                      <div class="status-dot"
                        [class]="sensor.latest_value !== null ? 'status-online' : 'status-offline'">
                      </div>
                      <span class="text-sm font-semibold"
                        [class]="sensor.latest_value !== null ? 'text-success-600' : 'text-gray-500'">
                        {{ sensor.latest_value !== null ? 'Online' : 'Offline' }}
                      </span>
                    </div>
                  </div>

                  <div class="flex-1 flex flex-col justify-center items-center text-center"
                    *ngIf="sensor.latest_value !== null">
                    <div class="sensor-value text-center">{{ sensor.latest_value }} lux</div>
                    <div class="sensor-timestamp text-center">{{ sensor.latest_timestamp | date:'short' }}</div>
                  </div>

                  <div class="flex-1 flex flex-col justify-center items-center text-center"
                    *ngIf="sensor.latest_value === null">
                    <div class="sensor-value-offline text-center">-- lux</div>
                    <div class="sensor-timestamp text-center">Tidak ada data</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Light Data Table -->
            <div class="mt-8 bg-white rounded-lg border border-gray-200">
              <div class="px-6 py-4 border-b border-gray-200">
                <h5 class="text-lg font-semibold text-gray-900">📋 Data Terbaru (30 Menit Terakhir)</h5>
              </div>

              <!-- Loading State -->
              <div *ngIf="lightTableLoading" class="text-center py-8">
                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-2"></div>
                <p class="text-gray-600">Memuat data cahaya...</p>
              </div>

              <!-- Data Table -->
              <div *ngIf="!lightTableLoading && lightTableData" class="overflow-x-auto">
                <table class="min-w-full bg-white">
                  <thead class="bg-gray-50">
                    <tr>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama
                        Sensor</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                        Intensitas Cahaya (lux)</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Waktu
                      </th>
                    </tr>
                  </thead>
                  <tbody class="bg-white divide-y divide-gray-200">
                    <tr *ngFor="let item of lightTableData.data; let i = index" class="hover:bg-gray-50">
                      <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ (lightTableData.current_page - 1)
                        * lightTableData.per_page + i + 1 }}</td>
                      <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ item.name }}</td>
                      <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ item.value }} lux</td>
                      <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ formatTableDate(item.created_at)
                        }}</td>
                    </tr>
                  </tbody>
                </table>

                <!-- Pagination -->
                <div class="px-6 py-4 border-t border-gray-200" *ngIf="lightTableData && lightTableData.last_page > 1">
                  <app-pagination [currentPage]="lightTableData.current_page" [totalPages]="lightTableData.last_page"
                    [totalItems]="lightTableData.total" [itemsPerPage]="lightTableData.per_page"
                    (pageChange)="onLightTablePageChange($event)">
                  </app-pagination>
                </div>
              </div>

              <!-- No Data State -->
              <div *ngIf="!lightTableLoading && (!lightTableData || lightTableData.data.length === 0)"
                class="text-center py-8">
                <div class="text-4xl mb-2">💡</div>
                <p class="text-gray-600">Tidak ada data cahaya ditemukan</p>
              </div>
            </div>
          </div>
        </div>

        <div class="text-center py-16" *ngIf="lightSensorsData.length === 0">
          <div class="text-8xl mb-6">💡</div>
          <h3 class="text-xl font-bold text-gray-900 mb-4">Tidak Ada Sensor Cahaya Ditemukan</h3>
          <p class="text-gray-600 text-lg">Data sensor cahaya tidak tersedia saat ini.</p>
        </div>
      </div>

      <!-- Turbidity Sensors Section -->
      <div class="card mb-8">
        <div class="section-header">
          <h2 class="text-3xl font-bold text-gray-900 mb-3">🌫️ Sensor Kekeruhan</h2>
          <p class="text-gray-600">Pemantauan kekeruhan real-time di semua sensor (30 Menit terakhir)</p>
        </div>

        <div class="space-y-8" *ngIf="turbiditySensorsData.length > 0">
          <div class="bg-gradient-to-r from-primary-50 to-primary-100 rounded-2xl p-8 border border-primary-200"
            *ngFor="let sensor of turbiditySensorsData; let i = index">
            <div class="grid lg:grid-cols-12 gap-9">
              <div class="chart-container lg:col-span-9">
                <div class="mb-4">
                  <h4 class="text-lg font-semibold text-gray-900">📊 {{ sensor.name }} - Tren Kekeruhan (30 Menit
                    Terakhir)</h4>
                </div>

                <div class="chart-wrapper">
                  <apx-chart [series]="getTurbidityChartSeries(sensor)" [chart]="getChartOptions(sensor)"
                    [colors]="getChartColors(i)" [stroke]="getChartStroke()" [fill]="getChartFill()"
                    [markers]="getChartMarkers(i)" [xaxis]="getChartXAxis()" [yaxis]="getTurbidityChartYAxis()"
                    [legend]="getChartLegend()" [tooltip]="getTurbidityChartTooltip()" [grid]="getChartGrid()"
                    [theme]="getChartTheme()">
                  </apx-chart>
                </div>
              </div>

              <div class="sensor-info lg:col-span-3">
                <div class="card p-6 h-full flex flex-col">
                  <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-900">{{ sensor.name }}</h3>
                    <div class="flex items-center gap-3">
                      <div class="status-dot"
                        [class]="sensor.latest_value !== null ? 'status-online' : 'status-offline'">
                      </div>
                      <span class="text-sm font-semibold"
                        [class]="sensor.latest_value !== null ? 'text-success-600' : 'text-gray-500'">
                        {{ sensor.latest_value !== null ? 'Online' : 'Offline' }}
                      </span>
                    </div>
                  </div>

                  <div class="flex-1 flex flex-col justify-center items-center text-center"
                    *ngIf="sensor.latest_value !== null">
                    <div class="sensor-value text-center">{{ sensor.latest_value }} NTU</div>
                    <div class="sensor-timestamp text-center">{{ sensor.latest_timestamp | date:'short' }}</div>
                  </div>

                  <div class="flex-1 flex flex-col justify-center items-center text-center"
                    *ngIf="sensor.latest_value === null">
                    <div class="sensor-value-offline text-center">-- NTU</div>
                    <div class="sensor-timestamp text-center">Tidak ada data</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Turbidity Data Table -->
            <div class="mt-8 bg-white rounded-lg border border-gray-200">
              <div class="px-6 py-4 border-b border-gray-200">
                <h5 class="text-lg font-semibold text-gray-900">📋 Data Terbaru (30 Menit Terakhir)</h5>
              </div>

              <!-- Loading State -->
              <div *ngIf="turbidityTableLoading" class="text-center py-8">
                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-2"></div>
                <p class="text-gray-600">Memuat data kekeruhan...</p>
              </div>

              <!-- Data Table -->
              <div *ngIf="!turbidityTableLoading && turbidityTableData" class="overflow-x-auto">
                <table class="min-w-full bg-white">
                  <thead class="bg-gray-50">
                    <tr>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama
                        Sensor</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                        Turbidity (NTU)</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Waktu
                      </th>
                    </tr>
                  </thead>
                  <tbody class="bg-white divide-y divide-gray-200">
                    <tr *ngFor="let item of turbidityTableData.data; let i = index" class="hover:bg-gray-50">
                      <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ (turbidityTableData.current_page
                        - 1) * turbidityTableData.per_page + i + 1 }}</td>
                      <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ item.name }}</td>
                      <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ item.value }} NTU</td>
                      <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ formatTableDate(item.created_at)
                        }}</td>
                    </tr>
                  </tbody>
                </table>

                <!-- Pagination -->
                <div class="px-6 py-4 border-t border-gray-200"
                  *ngIf="turbidityTableData && turbidityTableData.last_page > 1">
                  <app-pagination [currentPage]="turbidityTableData.current_page"
                    [totalPages]="turbidityTableData.last_page" [totalItems]="turbidityTableData.total"
                    [itemsPerPage]="turbidityTableData.per_page" (pageChange)="onTurbidityTablePageChange($event)">
                  </app-pagination>
                </div>
              </div>

              <!-- No Data State -->
              <div *ngIf="!turbidityTableLoading && (!turbidityTableData || turbidityTableData.data.length === 0)"
                class="text-center py-8">
                <div class="text-4xl mb-2">🌫️</div>
                <p class="text-gray-600">Tidak ada data kekeruhan ditemukan</p>
              </div>
            </div>
          </div>
        </div>

        <div class="text-center py-16" *ngIf="turbiditySensorsData.length === 0">
          <div class="text-8xl mb-6">🌫️</div>
          <h3 class="text-xl font-bold text-gray-900 mb-4">Tidak Ada Sensor Kekeruhan Ditemukan</h3>
          <p class="text-gray-600 text-lg">Data sensor kekeruhan tidak tersedia saat ini.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-gray-900 text-white pt-20 pb-6">
    <div class="container">
      <div class="grid md:grid-cols-3 gap-12 mb-12">
        <div class="footer-section">
          <h3 class="text-2xl font-bold mb-6 gradient-text">🌿 Nestle Kebun Raya Itera</h3>
          <p class="text-gray-300 leading-relaxed">Pantau kelembaban tanaman secara real-time dan jaga pertumbuhan tanaman dengan teknologi cerdas.</p>
        </div>
        <div class="footer-section">
          <h4 class="text-lg font-semibold mb-6">Tautan Cepat</h4>
          <div class="space-y-3">
            <a href="#hero" class="block text-gray-300 hover:text-white transition-colors">Home</a>
            <a href="#about" class="block text-gray-300 hover:text-white transition-colors">Tentang</a>
            <a (click)="goToContact()"
              class="block text-gray-300 hover:text-white transition-colors cursor-pointer">Kontak</a>
            <ng-container *ngIf="user$ | async as user; else footerLoginLink">
              <a (click)="goToDashboard()"
                class="block text-gray-300 hover:text-white transition-colors cursor-pointer">Dashboard</a>
            </ng-container>
            <ng-template #footerLoginLink>
              <a (click)="loginWithGoogle()"
                class="block text-gray-300 hover:text-white transition-colors cursor-pointer">Masuk</a>
            </ng-template>
          </div>
        </div>
        <div class="footer-section">
          <h4 class="text-lg font-semibold mb-6">Kontak</h4>
          <a href="https://www.google.com/maps/place/Botanical+Garden+of+Sumatra+Institute+of+Technology/@-5.3675434,105.3078577,17z/data=!3m1!4b1!4m6!3m5!1s0x2e40dd80f0cc7137:0x84d2b06bf14dd8f2!8m2!3d-5.3675487!4d105.3104326!16s%2Fg%2F11fb2vlmrf?entry=ttu&g_ep=EgoyMDI1MDcxNi4wIKXMDSoASAFQAw%3D%3D"
            target="_blank" class="text-gray-300 mb-3">
            <p class="text-gray-300 mb-3">📍 Kebun Raya ITERA</p>
          </a>
          <!-- Social Media Links -->
          <div class="flex space-x-3">
            <a href="https://www.instagram.com/kebunrayaitera?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw=="
              target="_blank"
              class="w-10 h-10 bg-gradient-to-r from-pink-500 to-purple-600 rounded-full flex items-center justify-center text-white hover:shadow-lg transition-all duration-300 hover:scale-110">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path
                  d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z" />
              </svg>
            </a>

            <a href="https://www.facebook.com/people/Kebun-Raya-ITERA/100064140279107/" target="_blank"
              class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white hover:shadow-lg transition-all duration-300 hover:scale-110">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path
                  d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" />
              </svg>
            </a>

            <a href="https://x.com/kebunrayaitera" target="_blank"
              class="w-10 h-10 bg-black rounded-full flex items-center justify-center text-white hover:shadow-lg transition-all duration-300 hover:scale-110">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path
                  d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" />
              </svg>
            </a>
          </div>
        </div>
      </div>
      <div class="border-t border-gray-800 pt-8 text-center">
        <p class="text-gray-400">&copy; 2025 Nestle Kebun Raya Itera.</p>
      </div>
    </div>
  </footer>

  <!-- Image Modal -->
  <div *ngIf="isImageModalOpen" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4"
    (click)="closeImageModal()">

    <!-- Modal Content -->
    <div class="relative max-w-4xl max-h-full w-full h-full flex items-center justify-center"
      (click)="$event.stopPropagation()">

      <!-- Close Button -->
      <button (click)="closeImageModal()"
        class="absolute top-4 right-4 z-10 bg-white/20 hover:bg-white/30 text-white p-2 rounded-full transition-colors duration-200">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>

      <!-- Main Image -->
      <div class="relative w-full h-full flex items-center justify-center">
        <img *ngIf="currentPlantTypeImages[currentImageIndex]"
          [src]="environment.apiUrl + '/storage/' + currentPlantTypeImages[currentImageIndex].image"
          [alt]="plantTypes[currentPlantTypeIndex].name"
          class="max-w-full max-h-full object-contain rounded-lg shadow-2xl">
      </div>

      <!-- Navigation Arrows -->
      <button *ngIf="currentPlantTypeImages.length > 1" (click)="previousImage()"
        class="absolute left-4 top-1/2 transform -translate-y-1/2 bg-white/20 hover:bg-white/30 text-white p-3 rounded-full transition-colors duration-200 z-10">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
        </svg>
      </button>

      <button *ngIf="currentPlantTypeImages.length > 1" (click)="nextImage()"
        class="absolute right-4 top-1/2 transform -translate-y-1/2 bg-white/20 hover:bg-white/30 text-white p-3 rounded-full transition-colors duration-200 z-10">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
        </svg>
      </button>

      <!-- Image Counter -->
      <div *ngIf="currentPlantTypeImages.length > 1"
        class="absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-black/50 text-white px-4 py-2 rounded-full text-sm">
        {{ currentImageIndex + 1 }} dari {{ currentPlantTypeImages.length }}
      </div>

      <!-- Thumbnail Navigation -->
      <div *ngIf="currentPlantTypeImages.length > 1"
        class="absolute bottom-20 left-1/2 transform -translate-x-1/2 flex space-x-2">
        <button *ngFor="let image of currentPlantTypeImages; let i = index" (click)="goToImage(i)"
          class="w-16 h-16 rounded-lg overflow-hidden border-2 transition-all duration-200"
          [class.border-white]="i === currentImageIndex" [class.border-transparent]="i !== currentImageIndex"
          [class.opacity-100]="i === currentImageIndex" [class.opacity-60]="i !== currentImageIndex">
          <img [src]="environment.apiUrl + '/storage/' + image.image" [alt]="plantTypes[currentPlantTypeIndex].name"
            class="w-full h-full object-cover">
        </button>
      </div>
    </div>
  </div>
</app-layout>